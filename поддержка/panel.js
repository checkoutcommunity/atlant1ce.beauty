$(document).ready(function(){$("body").removeClass("preload"),$("[rel='tooltip']").tooltip(),$("input[name='birth_date']:not(:disabled)").mask("99.99.9999"),$("select").styler(),$(".mobile-nav").slideAndSwipe(),update_payout_form(),$(window).on("show.bs.dropdown",function(){$("select").trigger("refresh")}),$(window).on("load resize",function(){scrolly(),sticky(),update_ticket_chat(),1400<$(window).width()?$(".sidebar > .links > a").tooltip("enable"):$(".sidebar > .links > a").tooltip("disable")}),$("input, textarea").live("focus input",function(){$(this).removeClass("error")}),$(".sidebar > .footer-toggle, .footer > .close").on("click",function(){$("footer > .wrapper").fadeToggle(150)}),$(".valid-num").live("input",function(){this.value!=this.value.replace(/[^0-9]/g,"")&&(this.value=this.value.replace(/[^0-9]/g,""))}),$(".valid-sum").live("input",function(){this.value!=this.value.replace(/[^0-9.]/g,"").replace(/[^.\d]+/g,"").replace(/^([^\.]*\.)|\./g,"$1").substring(0,8)&&(this.value=this.value.replace(",",".").replace(/[^0-9.]/g,"").replace(/[^.\d]+/g,"").replace(/^([^\.]*\.)|\./g,"$1").substring(0,8)),-1!=this.value.indexOf(".")&&3<this.value.length-this.value.indexOf(".")&&(this.value=this.value.substring(0,this.value.indexOf(".")+3))}),$(".modal .btn[data-action=cancel]").live("click",function(){$(".modal").modal("hide")}),$(".panel-projects .add").on("click",function(){$(".modal").modal("show"),$(".modal form.add").die("submit").live("submit",function(){var e=$(".modal select[name=url_scheme]").val(),t=$(".modal input[name=domain]").val(),a=$(".modal textarea[name=desc]").val(),o=$(".modal input[name=token]").val();return new RegExp(/^((?:(?:(?:\w[\.\-\+]?)*)([\-]{0,4}))+)((?:(?:(?:\w[\.\-\+]?){0,62})\w)+)\.([a-zA-Z0-9-]{2,10})$/).test(t)||$(".modal input[name=domain]").addClass("error"),a.length<10&&$(".modal textarea[name=desc]").addClass("error"),$(this).find("input, textarea").hasClass("error")||($(".modal .btn[data-action=add]").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({url:"/panel/main",type:"POST",data:{action:"add",url_scheme:e,domain:t,desc:a,token:o},cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.error?(note({content:e.error,type:"error",time:5}),e.highlight&&$(".modal [name="+e.highlight+"]").addClass("error"),$(".modal .btn[data-action=add]").removeClass("disabled").prop("disabled",!1).html("Добавить")):e.success&&($(".modal form").removeClass("add").addClass("confirm"),$(".modal form .add").hide(),$(".modal form .confirm").html(e.success).show(),$(".modal .btn[data-action=cancel]").attr("data-action","back").html("Назад"),$(".modal .btn[data-action=add]").removeClass("disabled").prop("disabled",!1).attr("data-action","confirm").html("Подтвердить"),$(".modal .btn[data-action=back]").on("click",function(){setTimeout(function(){$(".modal form").off("submit").removeClass("confirm").addClass("add"),$(".modal form .confirm").hide().html(""),$(".modal form .add").show(),$(".modal .btn[data-action=back]").off("click").attr("data-action","cancel").html("Отмена"),$(".modal .btn[data-action=confirm]").attr("data-action","add").html("Добавить")})}),$(".modal .btn-group button").on("click",function(){$(".new-project .btn-group button").prop("disabled",!1),$(this).prop("disabled",!0),$(".confirm .instruction div").hide(),$(".confirm .instruction ."+$(this).data("type")).show(),$(".confirm .instruction input[name=type]").val($(this).data("type"))}),$(".modal form.confirm").on("submit",function(){var e=$(".modal input[name=type]").val(),t=$(".modal input[name=token]").val();return $(".modal .btn[data-action=confirm]").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({url:"/panel/main",type:"POST",data:{action:"confirm",type:e,token:t},cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.error?(note({content:e.error,type:"error",time:5}),$(".modal .btn[data-action=confirm]").removeClass("disabled").prop("disabled",!1).html("Подтвердить")):e.success&&window.location.replace("/panel/main")},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".modal .btn[data-action=confirm]").removeClass("disabled").prop("disabled",!1).html("Подтвердить")}})},300),!1}))},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".modal .btn[data-action=add]").removeClass("disabled").prop("disabled",!1).html("Добавить")}})},300)),!1})}),$(".panel-transactions > .reload").on("click",function(){var e=$(".modal input[name=token]").val();$(".last-trans-scroll").getNiceScroll().hide(),$(".last-transactions, .no-transactions").css("opacity","0.5"),setTimeout(function(){$.ajax({url:"/panel/main",type:"POST",data:{action:"reload",token:e},cache:!1,success:function(e,t,a){"login"==a.getResponseHeader("Redirect")?window.location.replace("/panel/login"):"ajax"==a.getResponseHeader("Content")&&(e?($(".no-transactions").hide(),$(".last-transactions tbody").html(e)):($(".no-transactions").show(),$(".last-transactions tbody").html("")),$(".last-transactions, .no-transactions").css("opacity","1"),$(".last-trans-scroll").getNiceScroll().show().resize())},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".last-transactions, .no-transactions").css("opacity","1")}})},300)}),$(".filter-line").on("sticky-start",function(){setTimeout(function(){$(".table-responsive").removeClass("unsticky")},1)}),$(".filter-line").on("sticky-end",function(){setTimeout(function(){$(".table-responsive").addClass("unsticky")},1)}),$(".payout-block .dropdown-menu li a").on("click",function(){$(this).hasClass("disabled")||($(".payout-block > .title-page-dropdown > .text").html($(this).html()),$(".payout-block > .title-page-dropdown > .dropdown-menu > li > a").removeClass("disabled"),"mass"==$(this).data("type")?($(".payout-form").hide(),$(".masspayout-form").show(),$(".masspayout-list-block").getNiceScroll().resize()):($(".masspayout-form").hide(),$(".payout-form").show(),$(".masspayout-list-block").getNiceScroll().hide()),$(this).addClass("disabled"))}),$(".payout-form select[name='method']").on("change",function(e){update_payout_form(),e.preventDefault(),$(this).trigger("refresh"),$(".payout-form input[name='amount']").removeClass("error"),update_payout_amount("amount")}),$(".commission .payer").on("click",function(){$(".commission .payer").removeClass("selected"),$(this).addClass("selected"),$.ajax({url:"/panel/payout",type:"POST",data:{action:"save",commission:$(this).data("type"),token:$(".payout-form input[name='token']").val()},cache:!1,dataType:"json"}),$(".payout-form input[name='amount']").removeClass("error"),update_payout_amount("amount")}),$(".payout-form input").on("input",function(){update_payout_amount($(this).attr("name"))}),$(".payout-form form").on("submit",function(){var e=!1;return $(".payout-form input[name=amount]").val()<.01&&($(".payout-form input[name=amount]").addClass("error"),e=!0),e||($(".payout-form .btn").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/payout",data:$(".payout-form form").serialize()+"&action=create_payout",cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.error?(note({content:e.error,type:"error",time:5}),e.highlight&&$(".payout-form form input[name="+e.highlight+"]").addClass("error")):e.success&&(note({content:e.success,type:"success",time:5}),count=10,update_balance(),update_payout_list(!0,list),$(".payout-form form input[name=amount]").val("")),$(".payout-form .btn").removeClass("disabled").prop("disabled",!1).html("Отправить<span></span>"),update_payout_amount("amount")},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".payout-form .btn").removeClass("disabled").prop("disabled",!1).html("Отправить<span></span>"),update_payout_amount("amount")}})},300)),!1}),$(".masspayout-control .add-payment").on("click",function(){var e=!1;100<count&&(note({content:"Превышен лимит выплат",type:"error",time:5}),e=!0),e||(e=$(".payout-form select[name='method'] option[value=qiwi]").prop("disabled")?"disabled":"",wm_active=$(".payout-form select[name='method'] option[value=wm]").prop("disabled")?"disabled":"",ym_active=$(".payout-form select[name='method'] option[value=ym]").prop("disabled")?"disabled":"",usdt_active=$(".payout-form select[name='method'] option[value=usdt]").prop("disabled")?"disabled":"",mp_active=$(".payout-form select[name='method'] option[value=mp]").prop("disabled")?"disabled":"",card_active=$(".payout-form select[name='method'] option[value=card]").prop("disabled")?"disabled":"",$(".masspayout-list-block").append("<div class='masspayout-block'>         <div class='column'><select name='method[]' class='method'>         <option value='qiwi' class='qiwi' "+e+">QIWI</option>         <option value='card' class='card' "+card_active+">Банк. карта</option>         <option value='ym' class='ym' "+ym_active+">ЮMoney</option>         <option value='usdt' class='usdt' "+usdt_active+">Tether</option>         <option value='wm' class='wm' "+wm_active+">Webmoney</option>         <option value='mp' class='mp' "+mp_active+">Моб. телефон</option></select></div>         <div class='column'><input type='text'  name='account_number[]'  class='form-control' placeholder='Счет получателя' autocomplete='off'> </div>         <div class='column'><input type='text'  name='amount[]'  class='form-control valid-sum' placeholder='Сумма' inputmode='decimal' autocomplete='off'> </div>         <div class='column'><i class='delete'></i></div>         <input type='hidden' name='method_currency[]' value='RUB'>          <input type='hidden' name='counter[]' value='1'>          </div>"),count=+count+1,1<=count&&$(".masspayout-block .delete").css("display","block"),$(".masspayout-list-block").height()>=$(window).height()-351?($(".masspayout-list-block").addClass("scroll"),$(".masspayout-list-block").getNiceScroll().show().resize(),$(".masspayout-list-block").scrollTop($(".masspayout-list-block").prop("scrollHeight"))):($(".masspayout-list-block").removeClass("scroll"),$(".masspayout-list-block").getNiceScroll().hide()),setTimeout(function(){$(".masspayout-block select").styler({onSelectOpened:function(){$(".masspayout-list-block").getNiceScroll().resize()},onSelectClosed:function(){$(".masspayout-list-block").getNiceScroll().resize()}})},1))}),$(".masspayout-block select[name='method[]']").live("change",function(e){e.preventDefault(),$(this).trigger("refresh"),$(this).closest(".masspayout-block").find("input[name='account_number[]']").removeClass("error"),$(this).closest(".masspayout-block").find("input[name='amount[]']").removeClass("error"),"card"==$(this).val()?($(this).closest(".column").addClass("long").append("<select class='method-currency'><option value='RUB'>RUB</option><option value='UAH'>UAH</option><option value='KZT'>KZT</option></select>"),setTimeout(function(){$("select").styler()},1)):$(this).closest(".column").removeClass("long").find(".method-currency").remove()}),$(".masspayout-block select[class='method-currency']").live("change",function(){$(this).closest(".masspayout-block").find("input[name='amount[]']").removeClass("error"),$(this).closest(".masspayout-block").find("input[name='method_currency[]']").val($(this).val())}),$(".masspayout-block .delete").live("click",function(){return count=+count-1,count<1&&$(".masspayout-block .delete").hide(),$(this).parent().parent().remove(),$(".masspayout-list-block").height()>=$(window).height()-351?($(".masspayout-list-block").addClass("scroll"),$(".masspayout-list-block").getNiceScroll().show().resize()):($(".masspayout-list-block").removeClass("scroll"),$(".masspayout-list-block").getNiceScroll().hide()),!1}),$(".masspayout-form form").on("submit",function(){var a=!1;return $(".masspayout-form input[name='account_number[]']").each(function(){var e,t=$(this).closest(".masspayout-block").find("select[name='method[]']").val();"qiwi"==t?e=new RegExp("^(992|91|7|380|77|44|995|998|37|66|507|90|84|82|996|1|66|81|994|972)[0-9]{8,11}$"):"card"==t?e=new RegExp("^[0-9]{16}$"):"ym"==t?e=new RegExp("^41001([0-9]{8,12})$"):"usdt"==t?e=new RegExp("^T([A-Za-z0-9]{33})$"):"wm"==t?e=new RegExp("^Z([0-9]{10,14})$"):"mp"==t&&(e=new RegExp("^79([0-9]{9})$")),e.test($(this).val())&&("card"!=t||valid_card($(this).val()))||(a=!0,$(this).addClass("error"))}),$(".masspayout-form input[name='amount[]']").each(function(){$(this).val()<.01&&(a=!0,$(this).addClass("error"))}),a||($(".masspayout-form .btn-primary").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/payout",data:$(".masspayout-form form").serialize()+"&action=create_masspayout",dataType:"json",success:function(e){var t;e.redirect?window.location.replace("/panel/login"):e.error?(e.highlight&&$(".masspayout-form form .masspayout-block:eq("+e.id+") input[name='"+e.highlight+"']").addClass("error"),note({content:e.error,type:"error",time:5})):e.success&&(update_balance(),update_payout_list(!0,list),count=0,t=$(".payout-form select[name='method'] option[value=qiwi]").prop("disabled")?"disabled":"",wm_active=$(".payout-form select[name='method'] option[value=wm]").prop("disabled")?"disabled":"",ym_active=$(".payout-form select[name='method'] option[value=ym]").prop("disabled")?"disabled":"",usdt_active=$(".payout-form select[name='method'] option[value=usdt]").prop("disabled")?"disabled":"",mp_active=$(".payout-form select[name='method'] option[value=mp]").prop("disabled")?"disabled":"",card_active=$(".payout-form select[name='method'] option[value=card]").prop("disabled")?"disabled":"",$(".masspayout-list-block").html("<div class='masspayout-block'>                 <div class='column'><select name='method[]' class='method'>                 <option value='qiwi' class='qiwi' "+t+">QIWI</option>                 <option value='card' class='card' "+card_active+">Банк. карта</option>                 <option value='ym' class='ym' "+ym_active+">ЮMoney</option>                 <option value='usdt' class='usdt' "+usdt_active+">Tether</option>                 <option value='wm' class='wm' "+wm_active+">Webmoney</option>                 <option value='mp' class='mp' "+mp_active+">Моб. телефон</option></select></div>                 <div class='column'><input type='text' name='account_number[]' class='form-control' placeholder='Счет получателя' autocomplete='off'></div>                 <div class='column'><input type='text' name='amount[]'  class='form-control valid-sum' placeholder='Сумма' inputmode='decimal' autocomplete='off'></div>                 <div class='column'><i class='delete'></i></div>                 <input type='hidden' name='method_currency[]' value='RUB'>                  <input type='hidden' name='counter[]' value='1'>                  </div>"),setTimeout(function(){$("select").styler()},1),$(".masspayout-list-block").height()>=$(window).height()-351?($(".masspayout-list-block").addClass("scroll"),$(".masspayout-list-block").getNiceScroll().show().resize()):($(".masspayout-list-block").removeClass("scroll"),$(".masspayout-list-block").getNiceScroll().hide()),note({content:e.success,type:"success",time:5})),$(".masspayout-form .btn-primary").removeClass("disabled").prop("disabled",!1).html("Отправить")},error:function(){$(".masspayout-form .btn-primary").removeClass("disabled").prop("disabled",!1).html("Отправить"),note({content:"Ошибка соединения с сервером",type:"error",time:5})}})},300)),!1}),$(".payout-list-box select[name='status']").on("change",function(){list=10,update_payout_list()}),$(".payout-list-box input[name='from']").on("dp.change",function(e){$(".payout-list-box input[name='to']").data("DateTimePicker").setMinDate(e.date),list=10,update_payout_list(),$(".payout-list-box input[name='to']").focus().click()}),$(".payout-list-box input[name='from']").on("dp.hide",function(e){this.blur()}),$(".payout-list-box input[name='to']").on("dp.change",function(e){$(".payout-list-box input[name='from']").data("DateTimePicker").setMaxDate(e.date),list=10,update_payout_list()}),$(".payout-list-box input[name='to']").on("dp.hide",function(e){this.blur()}),$(".payout-list-box input[name='search']").on("input",function(){list=10,update_payout_list()}),$(".load-payouts").live("click",function(){list+=10,update_payout_list(!1,list)}),$(".payout-filter-export").on("click",function(){var e,t,a,o,i;$(this).hasClass("loading")||(e=$(".payout-form input[name='token']").val(),t=t||$(".payout-list-box select[name='status']").val(),a=$(".payout-list-box input[name='from']").val(),o=$(".payout-list-box input[name='to']").val(),i=$(".payout-list-box input[name='search']").val(),$(".payout-filter-export").addClass("loading").html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({url:"/panel/payout",type:"POST",data:{action:"export",status:t,from:a,to:o,search:i,token:e},cache:!1,dataType:"json",success:function(e){var t;e.redirect?window.location.replace("/panel/login"):e.error?note({content:e.error,type:"error",time:5}):e.success&&((t=$("<a>")).attr("href",e.success),$("body").append(t),t.attr("download","anypay_payouts_"+a+"-"+o+".xlsx"),t[0].click(),t.remove()),$(".payout-filter-export").removeClass("loading").html("")},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".payout-filter-export").removeClass("loading").html("")}})},300))}),$(".payout-table tbody tr").live("click",function(){var e=$(this).data("id"),t=$(".payout-form input[name='token']").val();$.ajax({type:"POST",url:"/panel/payout",data:{action:"info",payout:e,token:t},success:function(e,t,a){"login"==a.getResponseHeader("Redirect")?window.location.replace("/panel/login"):"ajax"==a.getResponseHeader("Content")&&($(".payout-info-result").html(e),$(".modal-backdrop").remove(),$(".modal-info").modal("show"))},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5})}})}),$(".checkbox-block input[type=checkbox]").change(function(){this.checked?$(this).parent().parent().addClass("active"):$(this).parent().parent().removeClass("active")}),$(".payment-filter select[name=status], .payment-filter select[name='method']").on("change",function(){list=20,update_payment_list($(".payment-filter input[name='token']").data("project"))}),$(".payment-filter input[name=from]").on("dp.change",function(e){$(".payment-filter input[name=to]").data("DateTimePicker").setMinDate(e.date),list=20,update_payment_list($(".payment-filter input[name='token']").data("project")),$(".payment-filter input[name=to]").focus().click()}),$(".payment-filter input[name=from]").on("dp.hide",function(e){this.blur()}),$(".payment-filter input[name=to]").on("dp.change",function(e){$(".payment-filter input[name=from]").data("DateTimePicker").setMaxDate(e.date),list=20,update_payment_list($(".payment-filter input[name='token']").data("project"))}),$(".payment-filter input[name=to]").on("dp.hide",function(e){this.blur()}),$(".payment-filter input[name=search]").on("input",function(){list=20,update_payment_list($(".payment-filter input[name='token']").data("project"))}),$(".load-payments").live("click",function(){list+=20,update_payment_list($(".payment-filter input[name=token]").data("project"),list)}),$(".payment-filter select[name=method]").styler("destroy").styler({selectSearch:"true",onSelectOpened:function(){$(".jq-selectbox__search input").focus()}}),$(".payment-filter-line").on("sticky-start",function(){$(".payment-filter input[name='from'], .payment-filter input[name='to']").blur()}),$(".payment-filter-line").on("sticky-end",function(){$(".payment-filter input[name='from'], .payment-filter input[name='to']").blur()}),$(".payment-filter-export").on("click",function(){var a,e,t,o,i,n,s;$(this).hasClass("loading")||(a=$(".payment-filter input[name='token']").data("project"),e=$(".payment-filter select[name='status']").val(),t=$(".payment-filter select[name='method']").val(),o=$(".payment-filter input[name='from']").val(),i=$(".payment-filter input[name='to']").val(),n=$(".payment-filter input[name='search']").val(),s=$(".payment-filter input[name='token']").val(),$(".payment-filter-export").addClass("loading").html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({url:"/panel/project/"+a+"/stat",type:"POST",data:{action:"export",status:e,method:t,from:o,to:i,search:n,token:s},cache:!1,dataType:"json",success:function(e){var t;e.redirect?window.location.replace("/panel/login"):e.error?note({content:e.error,type:"error",time:5}):e.success&&((t=$("<a>")).attr("href",e.success),$("body").append(t),t.attr("download","anypay_payments_"+a+"_"+o+"-"+i+".xlsx"),t[0].click(),t.remove()),$(".payment-filter-export").removeClass("loading").html("")},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".payment-filter-export").removeClass("loading").html("")}})},300))}),$(".payment-table tbody tr").live("click",function(){var e=$(".payment-filter input[name='token']").data("project"),t=$(this).data("id"),a=$(".payment-filter input[name='token']").val();$.ajax({type:"POST",url:"/panel/project/"+e+"/stat",data:{action:"info",payment:t,token:a},success:function(e,t,a){"login"==a.getResponseHeader("Redirect")?window.location.replace("/panel/login"):"ajax"==a.getResponseHeader("Content")&&($(".payment-info-result").html(e),$(".modal-backdrop").remove(),$(".modal-info").modal("show"),$("select").styler(),$(".modal-info .selector select").on("change",function(){$(".modal-info .modal-body .section").hide(),$(".modal-info .modal-body ."+$(this).val()).show()}),$(".modal-info .resend").on("click",function(){var e=$(".payment-filter input[name='token']").data("project"),t=$(this).data("id"),a=$(".payment-filter input[name='token']").val();$(this).addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/project/"+e+"/stat",data:{action:"resend",payment:t,token:a},cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.error?(note({content:e.error,type:"error",time:5}),$(".modal-info .resend").removeClass("disabled").prop("disabled",!1).html("Отправить оповещение")):e.success&&(alert(e.success),$(".modal-info .resend").removeClass("disabled").prop("disabled",!1).html("Отправить оповещение"))},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".modal-info .resend").removeClass("disabled").prop("disabled",!1).html("Отправить оповещение")}})},300)}))},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5})}})}),$(".testing-box").on("submit",function(){var e=$(this).serialize(),t=$(".testing-box input[name='token']").data("project"),a=$(".testing-box input[name='pay_id']").val(),o=$(".testing-box input[name='amount']").val(),i=$(".testing-box input[name='email']").val(),n=new RegExp(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,7})+$/);return a.length<1&&$(".testing-box input[name=pay_id]").addClass("error"),o.length<1&&$(".testing-box input[name=amount]").addClass("error"),n.test(i)||$(".testing-box input[name='email']").addClass("error"),$(".testing-box").find("input").hasClass("error")||($(".testing-box .btn-primary").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/project/"+t+"/testing",data:e+"&action=send",cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.error?(note({content:e.error,type:"error",time:5}),$(".testing-box .btn-primary").removeClass("disabled").prop("disabled",!1).html("Отправить")):e.success&&($(".testing-result").html(e.success),$(".testing-box .btn-primary").removeClass("disabled").prop("disabled",!1).html("Отправить"))},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".testing-box .btn-primary").removeClass("disabled").prop("disabled",!1).html("Отправить")}})},300)),!1}),$(".widget-form input, .widget-form select").on("input change",function(){update_widget("form")}),$(".widget-form select").on("change",function(){"desc_type"==$(this).attr("name")?$(this).closest(".form-group").find("input[name='desc']").removeClass("error"):"amount_type"==$(this).attr("name")&&$(this).closest(".form-group").find("input[name='amount']").removeClass("error")}),$(".widget-button input, .widget-button select").on("input change",function(){update_widget("button")}),$(".widget-qr input, .widget-qr select").on("input change",function(){update_widget("qr")}),$(".widget-link input, .widget-link select").on("input change",function(){update_widget("link")}),$(".widget-code").on("click",function(){$(this).select()}),$(".widget-form, .widget-button, .widget-qr, .widget-link").on("submit",function(){var e=$(this).serialize(),t=$(this).find("input[name='token']").data("project"),a=$(this).find("input[name='token']").data("type"),o=$(".widget-"+a+" input[name='pay_id']").val(),i=$(".widget-"+a+" input[name='desc']").val(),n=$(".widget-form select[name='desc_type']").val(),s=$(".widget-"+a+" input[name='amount']").val(),l=$(".widget-form select[name='amount_type']").val(),c=$(this).find(".btn").text();return o<1&&$(".widget-"+a+" input[name='pay_id']").addClass("error"),i.length<1&&("form"==a&&0==n||"form"!=a)&&$(".widget-"+a+" input[name='desc']").addClass("error"),s<1&&("form"==a&&0==l||"form"!=a)&&$(".widget-"+a+" input[name='amount']").addClass("error"),$(this).find("input").hasClass("error")||($(".widget-"+a+" .btn").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/project/"+t+"/widgets",data:e+"&type="+a+"&action=generate",cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.success&&(update_widget(a,t,e.success),$(".widget-"+a).closest(".newcontain").find(".widget-code").show(),$(".widget-"+a+" .btn").prop("disabled",!1).html(c))},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".widget-"+a+" .btn").prop("disabled",!1).html(c)}})},300)),!1}),$(".save-form").on("submit",function(){var e=$(this).data("page"),t=$(this).serialize();return $(this).data("check")&&$($(this).serializeArray()).each(function(){this.value.length<1&&$(".save-form input[name="+this.name+"]").addClass("error")}),$(this).find("input, textarea").hasClass("error")||($(this).find(".btn-primary").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({url:"/panel"+e,type:"POST",data:t+"&action=save",cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.error||e.highlight?(e.error&&note({content:e.error,type:"error",time:5}),e.highlight&&$(e.highlight.split(", ")).each(function(e,t){$(".save-form input[name="+t+"]").addClass("error")})):e.success&&note({content:e.success,type:"success",time:5}),$(".save-form .btn-primary.disabled").removeClass("disabled").prop("disabled",!1).html("Сохранить")},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".save-form .btn-primary.disabled").removeClass("disabled").prop("disabled",!1).html("Сохранить")}})},300)),!1}),$(".form-group .add, .form-group .delete").on("click",function(){var e=$(this).hasClass("add")?"add":"delete",t=$(this).data("type"),a=$(".save-form input[name=token]").val();"phone"==t?"add"==e?$.ajax({type:"POST",url:"/panel/cabinet",data:{action:"add",type:"phone",token:a},cache:!1,dataType:"json",success:function(e){var t;e.redirect?window.location.replace("/panel/login"):e.success&&($(".cabinet-action-result").html("<div class='modal fade'><div class='modal-dialog'><div class='modal-content'><div class='modal-header'>Телефон</div><div class='modal-close' data-dismiss='modal'></div><form class='add'><div class='modal-body form-horizontal'><div class='float'><input type='text' name='number' value='"+e.success+"' class='form-control' placeholder='Номер телефона' inputmode='numeric' autocomplete='off'></div></div><div class='modal-footer'><button type='button' class='btn btn-default' data-action='cancel'>Отмена</button><button type='submit' class='btn btn-primary' data-action='add'>Добавить</button></div></form></div></div></div>"),$(".modal-backdrop").remove(),$(".modal").modal("show"),e=document.querySelector(".modal input[name=number]"),t=$(".modal input[name=number]").val(),iti=window.intlTelInput(e,{allowDropdown:!1,nationalMode:!1,utilsScript:"../../template/js/utils.js",initialCountry:"auto",autoPlaceholder:"off",autoHideDialCode:!1}),float("focus"),setTimeout(function(){$(".modal input[name=number]").focus().val("").val(t)},150),$(".modal input[name=number]").on("input",function(){new RegExp("^[+][0-9]+$").test($(this).val())||(this.value=this.value.replace(/[^0-9]/g,""),this.value="+"+this.value)}),$(".modal form.add").on("submit",function(){var e=$(".modal input[name=number]").val();return iti.isValidNumber()||$(".modal input[name=number]").addClass("error"),$(".modal input[name=number]").hasClass("error")||($(".modal .btn[data-action=add]").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/cabinet",data:{action:"add",type:"phone",number:e,token:a},cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.error?(note({content:e.error,type:"error",time:5}),e.highlight&&$(".modal input[name="+e.highlight+"]").addClass("error"),"1"==e.code&&$(".modal").modal("hide"),$(".modal .btn[data-action=add]").removeClass("disabled").prop("disabled",!1).html("Добавить")):e.success&&($(".modal form").off("submit").removeClass("add").addClass("confirm"),$(".modal .modal-body").html("<div class='float'><input type='text' name='code' class='form-control valid-num' placeholder='Код из СМС' maxlength='6' inputmode='numeric' autocomplete='off'></div>"),$(".modal .btn[data-action=add]").removeClass("disabled").prop("disabled",!1).attr("data-action","confirm").html("Подтвердить"),float("focus"),$(".modal input[name=code]").focus(),$(".modal form.confirm").on("submit",function(){var e=$(".modal input[name=code]").val();return new RegExp("^[0-9]{6}$").test(e)||$(".modal input[name=code]").addClass("error"),$(".modal input[name=code]").hasClass("error")||($(".modal .btn[data-action=confirm]").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/cabinet",data:{action:"confirm",type:"phone",code:e,token:a},cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.error?(note({content:e.error,type:"error",time:5}),e.highlight&&$(".modal input[name="+e.highlight+"]").addClass("error"),"1"==e.code&&$(".modal").modal("hide"),$(".modal .btn[data-action=confirm]").removeClass("disabled").prop("disabled",!1).html("Подтвердить")):e.success&&window.location.replace("/panel/cabinet")},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".modal .btn[data-action=confirm]").removeClass("disabled").prop("disabled",!1).html("Подтвердить")}})},300)),!1}))},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".modal .btn[data-action=add]").removeClass("disabled").prop("disabled",!1).html("Добавить")}})},300)),!1}))},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5})}}):"delete"==e&&($(this).hasClass("loading")||($(this).addClass("loading").html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/cabinet",data:{action:"delete",type:"phone",token:a},cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.error?(note({content:e.error,type:"error",time:5}),$(".form-group .loading").removeClass("loading").html("")):e.success&&($(".cabinet-action-result").html("<div class='modal fade'><div class='modal-dialog'><div class='modal-content'><div class='modal-header'>Телефон</div><div class='modal-close' data-dismiss='modal'></div><form class='confirm'><div class='modal-body form-horizontal'><div class='float'><input type='text' name='code' class='form-control valid-num' placeholder='Код из смс' maxlength='6' inputmode='numeric' autocomplete='off'></div></div><div class='modal-footer'><button type='button' class='btn btn-default' data-action='cancel'>Отмена</button><button type='submit' class='btn btn-primary' data-action='confirm'>Подтвердить</button></div></form></div></div></div>"),$(".modal-backdrop").remove(),$(".modal").modal("show"),float("focus"),setTimeout(function(){$(".modal input[name=code]").focus()},150),$(window).on("shown.bs.modal",function(){$(".form-group .loading").removeClass("loading").html("")}),$(".modal form.confirm").on("submit",function(e){var t=$(".modal input[name=code]").val();return new RegExp("^[0-9]{6}$").test(t)||$(".modal input[name=code]").addClass("error"),$(".modal input[name=code]").hasClass("error")||($(".modal .btn[data-action=confirm]").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/cabinet",data:{action:"confirm",type:"phone",code:t,token:a},cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.error?(note({content:e.error,type:"error",time:5}),e.highlight&&$(".modal input[name="+e.highlight+"]").addClass("error"),"1"==e.code&&$(".modal").modal("hide"),$(".modal .btn[data-action=confirm]").removeClass("disabled").prop("disabled",!1).html("Подтвердить")):e.success&&window.location.replace("/panel/cabinet")},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".modal .btn[data-action=confirm]").removeClass("disabled").prop("disabled",!1).html("Подтвердить")}})},300)),!1}))},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".form-group .loading").removeClass("loading").html("")}})},300))):"telegram"==t&&("add"==e?$.ajax({type:"POST",url:"/panel/cabinet",data:{action:"add",type:"telegram",token:a},cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.success&&($(".cabinet-action-result").html("<div class='modal fade'><div class='modal-dialog'><div class='modal-content'><div class='modal-header'>Телеграм</div><div class='modal-close' data-dismiss='modal'></div><div class='modal-body form-horizontal'><div class='float'><input type='text' name='code' value='"+e.success+"' class='form-control' placeholder='Код авторизации'  autocomplete='off' readonly></div><div class='info'>Перейдите в бот и введите код авторизации</div></div><div class='modal-footer'><button type='button' class='btn btn-default' data-action='cancel'>Отмена</button><button type='button' class='btn btn-primary' data-action='go'>Перейти</button></div></div></div></div>"),$(".modal-backdrop").remove(),$(".modal").modal("show"),float(),$(".modal .btn[data-action=go]").on("click",function(){var e=$(".modal input[name=code]").val();window.open("https://t.me/anypayrobot?start="+e)}))},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5})}}):"delete"==e&&($(".cabinet-action-result").html("<div class='modal fade'><div class='modal-dialog'><div class='modal-content'><div class='modal-header'>Телеграм</div><div class='modal-close' data-dismiss='modal'></div><form class='confirm'><div class='modal-body form-horizontal'>Вы больше не будете получать уведомления в телеграм</div><div class='modal-footer'><button type='button' class='btn btn-default' data-action='cancel'>Отмена</button><button type='submit' class='btn btn-primary' data-action='confirm'>Подтвердить</button></div></form><div class='clear'></div></div></div></div>"),$(".modal-backdrop").remove(),$(".modal").modal("show"),$(".modal form.confirm").on("submit",function(){return $(".modal .btn[data-action=confirm]").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/cabinet",data:{action:"delete",type:"telegram",token:a},cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.success&&window.location.replace("/panel/cabinet")},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".modal .btn[data-action=confirm]").removeClass("disabled").prop("disabled",!1).html("Подтвердить")}})},300),!1})))}),$(".form-group .generate").on("click",function(){var e=$(this).data("type"),t=$(".save-form input[name=token]").val();"api_key"==e&&$.ajax({type:"POST",url:"/panel/cabinet/api",data:{action:"generate",token:t},cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.success&&(note({content:e.success,type:"success",time:5}),$(".save-form input[readonly]").attr("type","text").val(e.key))},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5})}})}),$(".form-group input[name=wm]").on("focus",function(){0==this.value.length&&(this.value="Z"+this.value)}),$(".form-group input[name=wm]").on("input",function(){new RegExp("^Z([0-9]{1,30})$").test($(this).val())||(this.value=this.value.replace(/[^0-9]/g,""),this.value="Z"+this.value)}),$(".form-group input[name=wm]").on("blur",function(){1==this.value.length&&(this.value="")}),$(".form-group input[name=mp]").on("focus",function(){0==this.value.length&&(this.value="7"+this.value)}),$(".form-group input[name=mp]").on("input",function(){new RegExp("^7([0-9]{10})$").test($(this).val())||("7"!=$(this).val().substr(0,1)?(this.value=this.value.replace(/[^0-9]/g,""),this.value="7"+this.value):this.value=this.value.replace(/[^0-9]/g,""))}),$(".form-group input[name=mp]").on("blur",function(){1==this.value.length&&(this.value="")}),$(".create-ticket").on("submit",function(){return $(".create-ticket input, .create-ticket textarea").each(function(){$(this).val().trim().length<1&&$(this).addClass("error")}),$(this).find("input, textarea").hasClass("error")||($(".create-ticket .btn").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/support",data:$(".create-ticket").serialize()+"&action=create",cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.error?(note({content:e.error,type:"error",time:5}),$(".create-ticket .btn").removeClass("disabled").prop("disabled",!1).html("Отправить")):e.success&&window.location.replace("/panel/ticket/"+e.success)},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".create-ticket .btn").removeClass("disabled").prop("disabled",!1).html("Отправить")}})},300)),!1}),$(".ticket-chat .close").on("click",function(){var e=$(".ticket-chat input[name=token]").data("ticket"),t=$(".ticket-chat input[name=token]").val();$.ajax({url:"/panel/ticket/"+e,type:"POST",data:{action:"close",token:t},cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.success&&($(".ticket-list .ticket.active .status").removeClass("active").text("Закрыт"),$(".ticket-chat .item .status").removeClass().addClass("status closed").text("Закрыт"),$(".ticket-chat .close").addClass("hide"))}})}),$(".ticket-chat .attach").on("click",function(){$(".ticket-chat input[type=file]").click()}),$(".ticket-chat input[type=file]").on("change",function(){var e=$(".ticket-chat input[name=token]").data("ticket"),t=$(".ticket-chat input[name=token]").val(),a=!1;5<=count&&(note({content:"Можно прикрепить не более 5 изображений",type:"error",time:5}),$(this).val(""),a=!0),a||((a=new FormData).append("image",$(this)[0].files[0]),a.append("action","upload"),a.append("token",t),$.ajax({url:"/panel/ticket/"+e,type:"POST",data:a,cache:!1,dataType:"json",processData:!1,contentType:!1,success:function(e){var t;e.redirect?window.location.replace("/panel/login"):e.error?(note({content:e.error,type:"error",time:5}),$(".ticket-chat input[type=file]").val("")):e.success&&(t=Math.floor(100*Math.random())+1,$(".ticket-chat .input").append("<input type='hidden' name='image[]' value='"+e.success+"' data-id='"+t+"'>"),$(".ticket-chat .image").append("<div class='block' data-id='"+t+"'><div class='delete'></div><a href='../"+e.success+"' target='_blank'><div style='background: url(../"+e.success+") no-repeat 50% 0;'></div></a></div>"),$(".ticket-chat input[type=file]").val(""),count=+count+1,update_ticket_chat())},error:function(){note({content:"Не удалось загрузить изображение",type:"error",time:5}),$(".ticket-chat input[type=file]").val("")}}))}),$(".ticket-chat .image .delete").live("click",function(){$(".ticket-chat .input input[data-id="+$(this).parent().data("id")+"]").remove(),$(this).parent().remove(),count=+count-1,update_ticket_chat()}),$(".ticket-chat textarea").on("input",function(){$(this).outerHeight(50).outerHeight(this.scrollHeight),0<this.value.trim().length?$(".ticket-chat .send").addClass("active"):$(".ticket-chat .send").removeClass("active"),update_ticket_chat()}),$(".ticket-chat .send").on("click",function(){$(".ticket-chat form").submit()}),$(".ticket-chat form").on("submit",function(){var e=$(".ticket-chat input[name=token]").data("ticket"),t=$(this).serialize();return $(".ticket-chat .send").hasClass("sending")||($(".ticket-chat .send").addClass("sending"),$.ajax({type:"POST",url:"/panel/ticket/"+e,data:t+"&action=send",cache:!1,dataType:"json",success:function(e){e.redirect?window.location.replace("/panel/login"):e.error?note({content:e.error,type:"error",time:5}):e.success&&($(".ticket-chat .history").html(e.success),$(".ticket-list .ticket.active .status").removeClass("active").text("На рассмотрении"),$(".ticket-chat .item .status").removeClass().addClass("status waiting").text("На рассмотрении"),$(".ticket-chat .close").removeClass("hide"),$(".ticket-chat textarea").val("").outerHeight(50).outerHeight($(".ticket-send textarea").scrollHeight).focus(),$(".ticket-chat .send").removeClass("active").removeClass("sending"),$(".ticket-chat .image, .ticket-chat .input").html(""),update_ticket_chat())},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".ticket-chat .send").removeClass("sending")}})),!1})});var panel_chart_options={series:[],labels:[],chart:{height:200,width:767<window.innerWidth?"103%":"101%",type:"area",fontFamily:"Proxima Nova",zoom:{enabled:!1},toolbar:{show:!1},animations:{enabled:!1},parentHeightOffset:0,redrawOnWindowResize:!0,redrawOnParentResize:!0},dataLabels:{enabled:!1},stroke:{width:767<window.innerWidth?3:2.5,curve:"straight"},colors:["#7e5ba8","#e9e9e9ff"],fill:{colors:["#7e5ba8","#e9e9e9ff"],type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.5,opacityTo:.4,stops:[0,100],gradientToColors:["#f6f6f6"]}},grid:{show:!0,borderColor:"#ececefab",xaxis:{lines:{show:!1}},yaxis:{lines:{show:!0}}},tooltip:{enabled:!0,followCursor:!1,marker:{show:!1},y:{formatter:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ").replace(".00","")}}},xaxis:{opposite:!1,tickPlacement:"on",tooltip:{enabled:!1},labels:{hideOverlappingLabels:!1,rotate:0,maxHeight:20,offsetY:-3,style:{colors:"#828287",fontSize:767<window.innerWidth?"13px":"12px",fontWeight:400}},axisBorder:{show:!1},axisTicks:{show:!1},crosshairs:{stroke:{color:"#d6d6d6"}}},yaxis:[{labels:{maxWidth:15,offsetX:9,style:{colors:"#828287",fontSize:767<window.innerWidth?"13px":"12px",fontWeight:400},formatter:function(e){return Math.round(e)}},axisBorder:{show:!1},axisTicks:{show:!1}},{show:!1,min:1,max:1,labels:{maxWidth:15,offsetX:9,style:{colors:"#828287",fontSize:767<window.innerWidth?"13px":"12px",fontWeight:400},formatter:function(e){return Math.round(e)}},axisBorder:{show:!1},axisTicks:{show:!1}}],plotOptions:{bar:{columnWidth:"0%"}},legend:{show:!1},markers:{strokeColors:"#fff",hover:{size:4}}},payment_chart_options={series:[],labels:[],chart:{height:767<window.innerWidth?300:250,width:"101%",type:"area",fontFamily:"Proxima Nova",zoom:{enabled:!1},toolbar:{show:!1},animations:{enabled:!1},parentHeightOffset:0,redrawOnWindowResize:!0,redrawOnParentResize:!0},dataLabels:{enabled:!1},stroke:{width:767<window.innerWidth?3:2.5,curve:"straight"},colors:["#7e5ba8","#e9e9e9ff"],fill:{colors:["#7e5ba8","#e9e9e9ff"],type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.5,opacityTo:.4,stops:[0,100],gradientToColors:["#f6f6f6"]}},grid:{show:!0,borderColor:"#ececefab",xaxis:{lines:{show:!1}},yaxis:{lines:{show:!0}}},tooltip:{enabled:!0,followCursor:!1,marker:{show:!1},y:{formatter:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ").replace(".00","")}}},xaxis:{opposite:!1,tickPlacement:"on",tooltip:{enabled:!1},labels:{hideOverlappingLabels:!1,rotate:0,maxHeight:20,offsetY:-3,style:{colors:"#828287",fontSize:767<window.innerWidth?"13px":"12px",fontWeight:400}},axisBorder:{show:!1},axisTicks:{show:!1},crosshairs:{stroke:{color:"#d6d6d6"}}},yaxis:[{labels:{maxWidth:22,offsetX:9,style:{colors:"#828287",fontSize:767<window.innerWidth?"13px":"12px",fontWeight:400},formatter:function(e){return Math.round(e)}},axisBorder:{show:!1},axisTicks:{show:!1}},{show:!1,min:1,max:1,labels:{maxWidth:22,offsetX:9,style:{colors:"#828287",fontSize:767<window.innerWidth?"13px":"12px",fontWeight:400},formatter:function(e){return Math.round(e)}},axisBorder:{show:!1},axisTicks:{show:!1}}],plotOptions:{bar:{columnWidth:"0%"}},legend:{show:!1},markers:{strokeColors:"#fff",hover:{size:4}}};function float(a){$(".float input, .float textarea").each(function(e){$(this).wrap("<fieldset></fieldset>");var t=$(this).attr("placeholder");$(this).attr("placeholder",""),""!=$(this).val()||a?$(this).after('<label for="name" class="stay">'+t+"</label>"):$(this).after('<label for="name">'+t+"</label>")}),$(".float input, .float textarea").on("blur",function(){""==!$(this).val()?$(this).next().addClass("stay"):$(this).next().removeClass("stay")})}function sticky(){1400<=$(window).width()?($(".nav-stacked").sticky({topSpacing:10}).sticky("update"),$(".filter-line").sticky({topSpacing:0,className:"sticky"}).sticky("update"),$(".payment-filter-line").sticky({topSpacing:0,className:"sticky"}).sticky("update"),$(".filter-line").attr("style","width: "+$(".filter-line").width()+"px;"),$(".payment-filter-line").attr("style","width: "+$(".head-page-block").width()+"px;")):992<=$(window).width()?($(".nav-stacked").sticky({topSpacing:95}).sticky("update"),$(".filter-line, .payment-filter-line").removeAttr("style").unstick()):$(".nav-stacked, .filter-line, .payment-filter-line").removeAttr("style").unstick()}function scrolly(){1400<=$(window).width()?($(".masspayout-list-block, .payout-scroll, .panel-projects .list, .last-trans-scroll, .ticket-list").niceScroll({cursorcolor:"#c1c1c1",cursorwidth:1,cursorborder:"0px solid #fff",horizrailenabled:!1,railpadding:{right:0}}).show(),$(".masspayout-list-block, .payout-scroll, .panel-projects .list, .last-trans-scroll, .ticket-list").getNiceScroll().resize()):$(".masspayout-list-block, .payout-scroll, .panel-projects .list, .last-trans-scroll, .ticket-list").getNiceScroll().hide()}function valid_card(e){for(var t,a,o=0,i=e.split("").reverse(),n=a=0,s=i.length;a<s;n=++a)t=+(t=i[n]),o+=!(n%2)||(t*=2)<10?t:t-9;return o%10==0}function update_balance(){var e=$(".payout-form input[name='token']").val();$.ajax({url:"/panel/main",type:"POST",data:{action:"balance",token:e},cache:!1,dataType:"json",success:function(e){$(".navbar-right > li > .balance > b").html(e.balance)}})}function format_amount(e,t,a,o){new RegExp("^[0-9.]{0,8}$").test(e)||(t=!0,e=e.replace(",",".").replace(/[^0-9.]/g,"")),8<e.length&&"input"==a&&(t=!0,e=e.substring(0,8)),7<e.length&&"."==e.toString().slice(-1)&&(t=!0,e=e.toString().slice(0,-1)),("."==e.substr(0,1)||"0"==e.substr(0,1)&&"."!=e.substr(1,1))&&(t=!0,e=e.slice(1)),-1!=e.indexOf(".")&&3<e.length-e.indexOf(".")&&(t=!0,e=e.substring(0,e.indexOf(".")+3)),e!=e.replace(/[^.\d]+/g,"").replace(/^([^\.]*\.)|\./g,"$1")&&(t=!0,e=e.replace(/[^.\d]+/g,"").replace(/^([^\.]*\.)|\./g,"$1"));var i=e.toString().split(".");return 3<i[0].length&&(t=!0,i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g," "),e=i.join(".")),!!t&&("input"==a?$(o).val(e):e)}function update_payout_form(){$(".payout-form [data-name='payee-currency']").removeClass().addClass("left "+$(".payout-form select[name='method'] option:selected").data("payee-currency")),$(".payout-form [data-name='min-amount']").html($(".payout-form select[name='method'] option:selected").data("min-amount")),$(".payout-form [data-name='max-amount']").html($(".payout-form select[name='method'] option:selected").data("max-amount")),$(".payout-form [data-name='commission']").html($(".payout-form select[name='method'] option:selected").data("commission")+"%"+($(".payout-form select[name='method'] option:selected").data("fee")?" + "+$(".payout-form select[name='method'] option:selected").data("fee")+' <span class="currency">₽</span>':"")),$(".payout-form select[name='method'] option:selected").data("rate")?$(".payout-form [data-name='rate']").html("<br>Курс: "+$(".payout-form select[name='method'] option:selected").data("rate")):$(".payout-form  [data-name='rate']").html("")}function update_payout_amount(e){var t=$(".payout-form input[name='"+e+"']").val(),a=t.replace(/\s/g,"").replace(/[^.\d]+/g,"").replace(/^([^\.]*\.)|\./g,"$1").substring(0,8);"."==a.substr(0,1)&&(a=a.slice(1)),"."==a.slice(-1)&&(a=a.slice(0,-1)),-1!=a.indexOf(".")&&3<a.length-a.indexOf(".")&&(a=a.substring(0,a.indexOf(".")+3));var o=$(".payout-form select[name='method'] option:selected").val(),i=parseFloat($(".payout-form select[name='method'] option:selected").data("rate")),n=parseFloat($(".payout-form select[name='method'] option:selected").data("commission")),s=$(".payout-form .commission .selected").data("type"),e=(a/100*n).toFixed(2),n=$(".payout-form select[name='method'] option:selected").data("payee-currency");"card"==o&&"rub"==n&&(e=parseFloat(e)+parseFloat("50")),"usdt"==o&&(e=parseFloat(e)+parseFloat("150"));o="payer"==s?a:a-e<0?0:a-e;button_amount="payer"==s?parseFloat(a)+parseFloat(e):a,i&&o&&(o=(o/i).toFixed(2)),!$.isNumeric(a)||a<.01?($(".payout-form input[name='payee_amount']").val(""),$(".payout-form .btn span").html("")):($(".payout-form .btn span").html(" "+format_amount(button_amount.toString(),!0)+' <span class="currency">₽</span>'),format_amount(o.toString(),!0,"input",".payout-form input[name='payee_amount']")),format_amount(t,!1,"input",".payout-form input[name='amount']")}function update_payout_list(e,i,t){i&&!e?$(".load-payouts").html("Загрузка...").attr("disabled",!0):e||$(".payout-table, .no-payouts, .load-payouts").css("opacity","0.5");var a=$(".payout-form input[name='token']").val(),t=t||$(".payout-list-box select[name='status']").val(),n=$(".payout-list-box input[name='from']").val(),s=$(".payout-list-box input[name='to']").val(),l=$(".payout-list-box input[name='search']").val(),i=i||10;setTimeout(function(){var o=JSON.parse($.ajax({url:"/panel/payout",type:"POST",data:{action:"count",status:t,from:n,to:s,search:l,token:a},global:!1,async:!1,success:function(e){return e}}).responseText);$.ajax({url:"/panel/payout",type:"POST",data:{action:"load",status:t,from:n,to:s,search:l,count:i,token:a},cache:!1,success:function(e,t,a){"login"==a.getResponseHeader("Redirect")?window.location.replace("/panel/login"):"ajax"==a.getResponseHeader("Content")&&(o.count<i?$(".load-payouts").hide():$(".load-payouts").show(),o.count<1?$(".no-payouts").show():$(".no-payouts").hide(),$(".payout-scroll").getNiceScroll().show().resize(),$(".payout-table tbody").html(e),$(".payout-table, .no-payouts, .load-payouts").css("opacity","1"),$(".load-payouts").html("Загрузить еще").attr("disabled",!1))},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".payout-table, .no-payouts, .load-payouts").css("opacity","1"),$(".load-payouts").html("Загрузить еще").attr("disabled",!1)}})},e?0:300)}function update_payment_list(e,n){n?$(".load-payments").html("Загрузка...").attr("disabled",!0):$(".apexcharts-canvas, .payment-table, .no-payments, .load-payments").css("opacity","0.5");var t=$(".payment-filter select[name=status]").val(),a=$(".payment-filter select[name=method]").val(),s=$(".payment-filter input[name=from]").val(),l=$(".payment-filter input[name=to]").val(),c=$(".payment-filter input[name=search]").val(),n=n||20,r=$(".payment-filter input[name=token]").val();setTimeout(function(){var o=JSON.parse($.ajax({url:"/panel/project/"+e+"/stat",type:"POST",data:{action:"count",status:t,method:a,from:s,to:l,search:c,token:r},global:!1,async:!1,success:function(e){return e}}).responseText),i=JSON.parse($.ajax({url:"/panel/project/"+e+"/stat",type:"POST",data:{action:"chart",status:t,method:a,from:s,to:l,search:c,token:r},global:!1,async:!1,success:function(e){return e}}).responseText);$.ajax({url:"/panel/project/"+e+"/stat",type:"POST",data:{action:"load",status:t,method:a,from:s,to:l,search:c,count:n,token:r},cache:!1,success:function(e,t,a){"login"==a.getResponseHeader("Redirect")?window.location.replace("/panel/login"):"ajax"==a.getResponseHeader("Content")&&($(".payment-info-box .count").html(o.count.toLocaleString()),$(".payment-info-box .sum").html(o.sum),o.count<n?$(".load-payments").hide():$(".load-payments").show(),o.count<1?$(".no-payments").show():$(".no-payments").hide(),$(".payment-table tbody").html(e),$(".apexcharts-canvas, .payment-table, .no-payments, .load-payments").css("opacity","1"),$(".load-payments").html("Загрузить еще").attr("disabled",!1),i&&payment_chart.updateOptions({series:[{type:"area",data:JSON.parse(i.sum)},{type:"column",data:JSON.parse(i.count)}],labels:JSON.parse(i.time)}),$("footer style").html(".payment-chart .apexcharts-xaxis-label:nth-child("+i.gap+"n+1){display: revert;}"))},error:function(){note({content:"Ошибка соединения с сервером",type:"error",time:5}),$(".apexcharts-canvas, .payment-table, .no-payments, .load-payments").css("opacity","1"),$(".load-payments").html("Загрузить еще").attr("disabled",!1)}})},300)}function update_widget(e,t,a){var o,i,n,s,l,c,r,d,p,m,u,h,v,f,y,b;$(".widget-"+e).closest(".newcontain").find(".widget-code").hide(),"form"==e?(u=$(".widget-form select[name=theme]").val(),r=$(".widget-form input[name=pay_id]").val(),b=$(".widget-form input[name=desc]").val(),v=$(".widget-form select[name=desc_type]").val(),h=$(".widget-form input[name=amount]").val(),o=$(".widget-form select[name=amount_type]").val(),y=$(".widget-form select[name=currency]").val(),i=$(".widget-form select[name=text]").val(),c=230,0==u?$(".widget-form-preview").removeClass("dark"):$(".widget-form-preview").addClass("dark"),1==v&&(c=+c+9),1==o&&(c=+c+18),1==(d="checked"==$(".widget-form input[name=fio]").attr("checked")?(n="<div class='form-area float'><input type='text' class='form-control' placeholder='ФИО'></div>",1):(n="",0))&&(c=+c+60),1==(m="checked"==$(".widget-form input[name=phone]").attr("checked")?(f="<div class='form-area float'><input type='text' class='form-control' placeholder='Номер телефона'></div>",1):(f="",0))&&(c=+c+60),1==(l="checked"==$(".widget-form input[name=address]").attr("checked")?(s="<div class='form-area float'><input type='text' class='form-control' placeholder='Адрес'></div>",1):(s="",0))&&(c=+c+60),c="width='400' height='"+c+"'",s="<div class='preview-form-header'></div> "+n+" "+f+" "+s+" "+(f=0==d&&0==m&&0==l?0==v?"<div class='form-desc'>"+b+"</div>":"<div class='form-desc-none float'><input type='text' class='form-control' placeholder='Назначение платежа'></div>":0==v?"<div class='form-desc'>"+b+"</div>":"<div class='form-desc-none-f float'><input type='text' class='form-control' placeholder='Назначение платежа'></div>")+"  "+(0==o?"<div class='form-footer'><div class='form-amount'>Сумма <span>"+h.replace(/[^0-9.]/g,"").replace(/\B(?=(\d{3})+(?!\d))/g," ")+" "+y+"</span></div>":"<div class='form-footer'><div class='form-amount none float'><input type='number' class='form-control' placeholder='Сумма'></div><div class='currency'>"+y+"</div>")+"<button class='f-but'>"+i+"</button></div>",c="<iframe src='https://anypay.io/widget/form?merchant_id="+t+"&pay_id="+r+"&amount="+h+"&currency="+y+"&desc="+encodeURIComponent(b)+"&text="+encodeURIComponent(i)+"&theme="+u+"&desc_type="+v+"&amount_type="+o+"&fio="+d+"&phone="+m+"&address="+l+"&sign="+a+"' "+c+" scrolling='no' frameBorder='0' noresize></iframe>",$(".widget-form-preview").html(s),t&&a?$(".widget-form").closest(".newcontain").find(".widget-code").val(c):$(".widget-form").closest(".newcontain").find(".widget-code").val(""),float()):"button"==e?(u=$(".widget-button select[name=theme]").val(),r=$(".widget-button input[name=pay_id]").val(),m=$(".widget-button input[name=desc]").val(),d=$(".widget-button input[name=amount]").val(),p=$(".widget-button select[name=currency]").val(),f=$(".widget-button select[name=text]").val(),b=$(".widget-button select[name=size]").val(),0==u?$(".widget-button-preview").removeClass("dark"):$(".widget-button-preview").addClass("dark"),v="small"==b?"width='240' height='45'":"middle"==b?"width='270' height='55'":"width='320' height='63'",h="<div class='button-block "+b+"'><span class='button-left'>"+d.replace(/[^0-9.]/g,"").replace(/\B(?=(\d{3})+(?!\d))/g," ")+" "+p+"</span><a class='button-right'>"+f+"</span></a>",v="<iframe src='https://anypay.io/widget/button?merchant_id="+t+"&pay_id="+r+"&amount="+d+"&currency="+p+"&desc="+encodeURIComponent(m)+"&text="+encodeURIComponent(f)+"&size="+b+"&theme="+u+"&sign="+a+"'  "+v+" scrolling='no' frameBorder='0' noresize></iframe>",$(".widget-button-preview").html(h),t&&a?$(".widget-button").closest(".newcontain").find(".widget-code").val(v):$(".widget-button").closest(".newcontain").find(".widget-code").val("")):"qr"==e?(f=$(".widget-qr input[name='pay_id']").val(),b=$(".widget-qr select[name='size']").val(),d=$(".widget-qr input[name='amount']").val(),p=$(".widget-qr select[name='currency']").val(),m=$(".widget-qr input[name='desc']").val(),h="<img "+(v="small"==b?"width='200' height='200'":"middle"==b?"width='250' height='250'":"width='300' height='300'")+" class='qr-block' src='https://anypay.io/widget/qr?merchant_id=null&amount=null&pay_id=null&desc=null&currency=RUB&theme="+(u=$(".widget-qr select[name='theme']").val())+"&sign=null'>",z="<img "+v+" style='border-radius: 5px; box-shadow: 0 10px 32px rgba(109, 109, 109, 0.16);' src='https://anypay.io/widget/qr?merchant_id="+t+"&amount="+d+"&pay_id="+f+"&desc="+m+"&currency="+p+"&theme="+u+"&sign="+a+"'>",$(".widget-qr-preview").html(h),t&&a?$(".widget-qr").closest(".newcontain").find(".widget-code").val(z):$(".widget-qr").closest(".newcontain").find(".widget-code").val("")):"link"==e&&(b=$(".widget-link input[name='pay_id']").val(),v=$(".widget-link input[name='desc']").val(),b="https://anypay.io/merchant?merchant_id="+t+"&pay_id="+b+"&amount="+(f=$(".widget-link input[name='amount']").val())+"&currency="+(y=$(".widget-link select[name='currency']").val())+"&desc="+encodeURIComponent(v)+"&sign="+a,t&&a?$(".widget-link").closest(".newcontain").find(".widget-code").val(b):$(".widget-link").closest(".newcontain").find(".widget-code").val(""))}function update_ticket_chat(){$(".ticket-chat > .wrapper").hasClass("visiable")||$(".ticket-chat > .wrapper").addClass("visiable"),1400<=$(window).width()?$(".ticket-chat > .wrapper").removeAttr("style").attr("style","height: "+($(window).height()-$(".ticket-chat > .title").height()-$(".ticket-chat > .info").height()-$(".ticket-chat > .form").height()-245)+"px;"):500<=$(window).width()?$(".ticket-chat > .wrapper").removeAttr("style").attr("style","height: "+($(".ticket-chat").height()-$(".ticket-chat > .title").height()-$(".ticket-chat > .info").height()-$(".ticket-chat > .form").height()-45)+"px;"):($(".ticket-chat").removeAttr("style").attr("style","height: "+($(window).height()-60)+"px;"),$(".ticket-chat > .wrapper").removeAttr("style").attr("style","height: "+($(".ticket-chat").height()-$(".ticket-chat > .form").height()-30)+"px;")),500<=$(window).width()?($(".ticket-chat > .wrapper").niceScroll({cursorcolor:"#c1c1c1",cursorwidth:1,cursorborder:"0px solid #fff",railpadding:{right:0}}).show(),$(".ticket-chat > .wrapper").getNiceScroll().resize()):$(".ticket-chat > .wrapper").getNiceScroll().hide(),$(".ticket-chat > .wrapper").scrollTop($(".ticket-chat > .wrapper").prop("scrollHeight"))}